@using OA.Web.Models
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>企云</title>
    <link href="~/Content/Iview/iview.css" rel="stylesheet" />
    <script src="~/Scripts/vue.js"></script>
    <script src="~/Scripts/IView/iview.js"></script>
    <script src="~/Scripts/vue-resource.js"></script>
</head>
<body>
    <style scoped>
        .layout {
            border: 1px solid #d7dde4;
            background: #f5f7f9;
            position: relative;
            border-radius: 4px;
            overflow: hidden;
        }

        .layout-header-bar {
            background: #fff;
            box-shadow: 0 1px 1px rgba(0,0,0,.1);
        }
    </style>
    <div id="app">
        <div class="layout">
            <Sider :style="{position: 'fixed', height: '100vh', left: 0, overflow: 'auto'}">
                <i-Menu v-on:on-select="test" :active-name="activeFromName" theme="dark" width="auto" >
                    <Submenu style="background-color:coral" name="4">
                        <template slot="title">
                            <Avatar style="color: #f56a00;background-color: #fde3cf">{{lastName}}</Avatar>
                            <span style="color:black;font-size:18px;font-style:initial">&nbsp&nbsp{{ui.UName}}</span>
                        </template>
                        <Menu-Item name="4-1" style="font-size:12px;background-color:chocolate">个人信息</Menu-Item>
                        <Menu-Item name="4-2" style="font-size:12px;background-color:chocolate">退出登陆</Menu-Item>
                    </Submenu>
                    <Menu-Item name="个人主页">个人主页</Menu-Item>
                    <Menu-Item name="1-1">企业周报</Menu-Item>
                    <Menu-Item name="1-2">企业信息</Menu-Item>
                    <Menu-Item name="1-3">企业论坛</Menu-Item>
                    <Submenu name="3">
                        <template slot="title">
                            <Icon type="ios-analytics"></Icon>
                            人员管理
                        </template>
                        <Menu-Item name="用户管理">用户管理</Menu-Item>
                        <Menu-Item name="角色管理">角色管理</Menu-Item>
                        <Menu-Item name="权限管理">权限管理</Menu-Item>
                    </Submenu>
                </i-Menu>
            </Sider>
            <Layout :style="{marginLeft: '200px'}">
                <Header :style="{background: '#fff', boxShadow: '0 2px 3px 2px rgba(0,0,0,.1)'}"></Header>
                <Content :style="{padding: '0 16px 16px'}">
                    <Breadcrumb :style="{margin: '16px 0'}">
                        <Breadcrumb-Item>OA系统</Breadcrumb-Item>
                        <Breadcrumb-Item>{{ui.UName}}</Breadcrumb-Item>
                        <Breadcrumb-Item>{{activeFromName}}</Breadcrumb-Item>

                    </Breadcrumb>
                    <Card>
                        <div style="height: 700px"><iframe frameborder="0" style="height: 640px;width:100%" :src="iframeSrc"></iframe></div>
                    </Card>
                </Content>
            </Layout>
        </div>
    </div>
</body>
<script>
      var v=  new Vue({
            el:'#app',
            data:{
                user:"",
                ui: [],
                iframeSrc: "",
                menuList: {
                    用户管理: "/UserMgr/index",
                    角色管理: "http://www.baidu.com",
                    权限管理: ""
                },                                                                                                                                                  
                activeFromName: "",
            },
            computed:{
                lastName: function () {
                    var str = this.ui.UName;
                    if ("undefined" != typeof str) {
                        var n = str.split("");
                        return n[n.length - 1]
                    } 
                    
                }

            },
            methods: {
                getActiveUInfo: function () {
                    this.$http.post("/Home/ActiveUserInfo").then(response => {
                        this.ui = response.body.ui;
                    }, function () {
                        alert("请求失败");
                        })
                },
                test: function (name) {
                    this.iframeSrc = this.menuList[name];
                    this.activeFromName = name;
                }
            },
            created: function () {
                this.getActiveUInfo();
                
            }
        })
</script>

</html>
